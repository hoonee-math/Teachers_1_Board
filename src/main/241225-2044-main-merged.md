# 디렉토리: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main

# 디렉토리: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java

# 디렉토리: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com

# 디렉토리: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt

# 디렉토리: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/controller

# 디렉토리: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/controller/post

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/controller/post/DistrictServlet.java
```java
package com.ttt.controller.post;

import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.ibatis.session.SqlSession;

import com.google.gson.Gson;
import com.ttt.common.SqlSessionTemplate;

/**
 * Servlet implementation class DistrictServlet
 */
@WebServlet("/post/district")
public class DistrictServlet extends HttpServlet {
	private static final long serialVersionUID = 1L;

	public DistrictServlet() {
        super();
    }

	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		String region = request.getParameter("region");
		List<String> districts = new ArrayList<>();
		
		try {
			SqlSession session = SqlSessionTemplate.getSession();
			districts = session.selectList("post.selectDistrict",region);
			
		} catch (Exception e) {
			e.printStackTrace();
		}
		
		response.setContentType("application/json;charset=UTF-8");
		new Gson().toJson(districts, response.getWriter());
	}

	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		doGet(request, response);
	}

}

```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/controller/post/SchoolServlet.java
```java
package com.ttt.controller.post;

import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.ibatis.session.SqlSession;

import com.google.gson.Gson;
import com.ttt.common.SqlSessionTemplate;

/**
 * Servlet implementation class SchoolServlet
 */
@WebServlet("/post/school")
public class SchoolServlet extends HttpServlet {
	private static final long serialVersionUID = 1L;
       
    public SchoolServlet() {
        super();
    }

	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		String district = request.getParameter("district");
		String schoolName = request.getParameter("schoolName");
		
		Map<String, String> params = new HashMap<>();
		params.put("district", district);
		params.put("schoolName", schoolName);
		
		List<String> schools = new ArrayList<>();
		
		try {
			SqlSession session = SqlSessionTemplate.getSession();
			schools = session.selectList("post.selectSchool",params);
		} catch (Exception e) {
			e.printStackTrace();
		}
		
		response.setContentType("application/json;charset=UTF-8");
		new Gson().toJson(schools, response.getWriter());
	}

	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		doGet(request, response);
	}

}

```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/controller/post/UploadEndServlet.java
```java
package com.ttt.controller.post;

import java.io.IOException;
import java.util.ArrayList;
import java.util.Enumeration;
import java.util.List;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.oreilly.servlet.MultipartRequest;
import com.oreilly.servlet.multipart.DefaultFileRenamePolicy;
import com.ttt.dto.Image1;
import com.ttt.dto.Member1;
import com.ttt.dto.Post1;
import com.ttt.dto.PostUploadMultiPartRequestDTO;
import com.ttt.service.PostService;

/**
 * Servlet implementation class UploadEndServlet
 */
@WebServlet("/post/uploadpostend")
public class UploadEndServlet extends HttpServlet {
	private static final long serialVersionUID = 1L;

    private PostService postService = new PostService();

	public UploadEndServlet() {
        super();
    }

	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
//		String path = getServletContext().getRealPath("/resources/upload/post");
//
//		CustomFileRenamePolicy renamePolicy = new CustomFileRenamePolicy(0, 0, 0); // 기본값 생성
//
//		MultipartRequest mr = new MultipartRequest(
//				request, path, 1024*1024*100, "utf-8",renamePolicy
//			);
//		
//		Member1 m = new Member1();
//		Post1 post = new Post1();
//		List<Image1> images = new ArrayList<>();
//		int order = 0;
//		
//		try {
//			//1. 기본 데이터 처리
//			m = Member1.builder()
//					.memberNo(Integer.parseInt(mr.getParameter("memberNo")))
//					.build();
//			post = Post1.builder()
//					.postTitle(mr.getParameter("postTitle"))
//					.postContent(mr.getParameter("postContent"))
//					.member(m)
//					.categoryNo(Integer.parseInt(mr.getParameter("categoryNo")))
//					.build();
//		} catch (Exception e) {
//			e.printStackTrace();
//		}
//		try { 
//			//2. 파일 처리
//			java.util.Enumeration<String> fileNames = mr.getFileNames();
//			while(fileNames.hasMoreElements()) {  // Enumeration 객체를 변수에 저장하여 사용
//			    String fileName = fileNames.nextElement();
//			    String oriname = mr.getOriginalFileName(fileName);
//			    String renamed = mr.getFilesystemName(fileName);
//			    
//			    if (oriname != null) {
//			        Image1 image = Image1.builder()
//			                .imgSeq(order++)
//			                .oriname(oriname)
//			                .renamed(renamed)
//			                .build();
//			        images.add(image);
//			    }
//			}
//	        //3. 서비스 호출
//	        post = new PostService().insertPost(post, images);
//		} catch (Exception e) {
//			e.printStackTrace();
//		}
//		
//		int memberNo = Integer.parseInt(mr.getParameter("memberNo"));
//		int categoryNo = Integer.parseInt(mr.getParameter("categoryNo"));
//		System.out.println(mr.getParameter("postNo"));
//		int postNo = Integer.parseInt(mr.getParameter("postNo"));
//		String postTitle = mr.getParameter("postTitle");
//		String postContent = mr.getParameter("postContent");
//		
//		renamePolicy.setMemberNo(memberNo);
//		renamePolicy.setPostNo(postNo);
//		renamePolicy.setImgSeq(order);
//		
//		try {
//	        //4.  결과 처리
//	        String msg = "게시글 등록 성공 :)", loc = "/board/list";
//	        if(post.getPostNo() == 0) {
//	        	msg = "게시글 등록 실패 :(";
//	        	loc = "/post/uploadpost";
//	        }
//	        
//	        request.setAttribute("msg", msg);
//	        request.setAttribute("loc", loc);
//	        request.getRequestDispatcher("/WEB-INF/views/common/msg.jsp")
//	               .forward(request, response);
//		} catch (Exception e) {
//			e.printStackTrace();
//			request.setAttribute("msg", "게시글 등록 중 오류 발생");
//	        request.setAttribute("loc", "/post/uploadpost");
//	        request.getRequestDispatcher("/WEB-INF/views/common/msg.jsp")
//	               .forward(request, response);
//		}
		

        try {
            // 1. 파일 업로드 처리
        	MultipartRequest mr = handleFileUpload(request);
            
            // 2. 게시글 기본 정보 처리
            Post1 post = createPostFromRequest(mr);
            
            // 3. 이미지 정보 처리
            List<Image1> images = createImagesFromUpload(mr);
            
            // 4. 서비스 호출하여 저장
            Post1 savedPost = postService.savePostWithImages(post, images);
            
            // 5. 결과 처리
            handleResponse(request, response, savedPost);
            
        } catch (Exception e) {
            handleError(request, response, e);
        }
	}

	private MultipartRequest handleFileUpload(HttpServletRequest request) throws Exception {
	    String path = getServletContext().getRealPath("/resources/upload/post");
	    return new MultipartRequest(
	        request, 
	        path, 
	        1024*1024*100, 
	        "utf-8",
	        new DefaultFileRenamePolicy() // CustomFileRenamePolicy 대신 기본 정책 사용
	    );
	}

    private Post1 createPostFromRequest(MultipartRequest mr) {
        return Post1.builder()
                .postTitle(mr.getParameter("postTitle"))
                .postContent(mr.getParameter("postContent"))
                .member(Member1.builder()
                        .memberNo(Integer.parseInt(mr.getParameter("memberNo"))) // 여기서는 예외처리를.. 안해줘도 되겠니? 무조건 받아올 값이니까?
                        .build())
                .categoryNo(Integer.parseInt(mr.getParameter("categoryNo")))
                .build();
    }

    private List<Image1> createImagesFromUpload(MultipartRequest mr) {
        List<Image1> images = new ArrayList<>();
        int order = 0;
        
        @SuppressWarnings("unchecked")
        Enumeration<String> fileNames = mr.getFileNames();  // MultipartRequest의 메서드 사용
        while(fileNames.hasMoreElements()) {
            String fileName = fileNames.nextElement();
            String oriname = mr.getOriginalFileName(fileName);
            String renamed = mr.getFilesystemName(fileName);
            
            if (oriname != null) {
                images.add(Image1.builder()
                        .imgSeq(order++)
                        .oriname(oriname)
                        .renamed(renamed)
                        .build());
            }
        }
        return images;
    }

    private void handleResponse(HttpServletRequest request, HttpServletResponse response, Post1 post) 
            throws ServletException, IOException {
        String msg = post.getPostNo() > 0 ? "게시글 등록 성공 :)" : "게시글 등록 실패 :(";
        String loc = post.getPostNo() > 0 ? "/board/list" : "/post/uploadpost";
        
        request.setAttribute("msg", msg);
        request.setAttribute("loc", loc);
        request.getRequestDispatcher("/WEB-INF/views/common/msg.jsp").forward(request, response);
    }

    private void handleError(HttpServletRequest request, HttpServletResponse response, Exception e) 
            throws ServletException, IOException {
        e.printStackTrace();
        request.setAttribute("msg", "게시글 등록 중 오류 발생: " + e.getMessage());
        request.setAttribute("loc", "/post/uploadpost");
        request.getRequestDispatcher("/WEB-INF/views/common/msg.jsp").forward(request, response);
    }
    
}

```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/controller/post/UploadPost2Servlet.java
```java
package com.ttt.controller.post;

import java.io.File;
import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.json.simple.JSONObject;

import com.oreilly.servlet.MultipartRequest;
import com.oreilly.servlet.multipart.DefaultFileRenamePolicy;

/**
 * Servlet implementation class UploadPost2Servlet
 */
@WebServlet("/uploadSummernoteImageFile")
public class UploadPost2Servlet extends HttpServlet {
	private static final long serialVersionUID = 1L;
       
    public UploadPost2Servlet() {
        super();
    }

	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
	}

	@Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        // 파일 저장 경로 설정
        String saveDirectory = getServletContext().getRealPath("/upload/summernote");
        File dir = new File(saveDirectory);
        if(!dir.exists()) dir.mkdirs();
        
        // multipart 데이터 처리
        MultipartRequest multipartRequest = new MultipartRequest(
                request,
                saveDirectory,
                1024*1024*10, // 10MB 제한
                "UTF-8",
                new DefaultFileRenamePolicy()
        );
        
        // 업로드된 파일 정보 가져오기
        File uploadedFile = multipartRequest.getFile("file");
        String originalFileName = multipartRequest.getOriginalFileName("file");
        String savedFileName = multipartRequest.getFilesystemName("file");
        
        // JSON 응답 생성
        response.setContentType("application/json;charset=UTF-8");
        PrintWriter out = response.getWriter();
        
        JSONObject jObj = new JSONObject();
        if(uploadedFile != null) {
            // 파일이 성공적으로 업로드된 경우
            String imageUrl = request.getContextPath() + "/upload/summernote/" + savedFileName;
            jObj.put("url", imageUrl);
            jObj.put("responseCode", "success");
        } else {
            // 업로드 실패
            jObj.put("responseCode", "error");
        }
        
        out.print(jObj.toJSONString());
    }

}

```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/controller/post/UploadServlet.java
```java
package com.ttt.controller.post;

import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.ibatis.session.SqlSession;

import com.ttt.common.SqlSessionTemplate;

@WebServlet(name="uploadPost", urlPatterns="/post/uploadpost")
public class UploadServlet extends HttpServlet {
	private static final long serialVersionUID = 1L;
	
    public UploadServlet() {
        super();
    }

	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		response.setContentType("text/html;charset=UTF-8");
		
		List<String> result = new ArrayList<>();
	
		try {
			SqlSession session = SqlSessionTemplate.getSession();
			result = session.selectList("post.selectRegion");
			session.commit();
			session.close();
		} catch (Exception e) {
			e.printStackTrace();
		}
		
		request.setAttribute("regions", result);
		
		request.getRequestDispatcher("/WEB-INF/views/post/uploadPost.jsp").forward(request, response);
	}

	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		doGet(request, response);
	}

}

```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/controller/post/UploadServlet2.java
```java
package com.ttt.controller.post;

import java.io.IOException;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.oreilly.servlet.MultipartRequest;
import com.oreilly.servlet.multipart.DefaultFileRenamePolicy;
import com.ttt.dto.Post1;

@WebServlet("/post/uploadpost2")
public class UploadServlet2 extends HttpServlet {
	private static final long serialVersionUID = 1L;
       
    public UploadServlet2() {
        super();
    }

	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		String path = getServletContext().getRealPath("/resources/upload/post");
	    MultipartRequest mr = new MultipartRequest(
	            request, path, 1024*1024*100, "utf-8", new DefaultFileRenamePolicy());
	            
	    // MultipartRequest로 파라미터 받기
	    String postTitle = mr.getParameter("boardTitle");
	    String postContent = mr.getParameter("boardContent");
	    String postWriter = mr.getParameter("boardWriter");
	    
	    // 테스트용 더미데이터
	    postTitle = postTitle != null ? postTitle : "테스트 제목";
	    postContent = postContent != null ? postContent : "테스트 내용";
	    postWriter = postWriter != null ? postWriter : "테스트 작성자";
	    
	    // Post 객체 생성 (주석 해제)
	    Post1 p = Post1.builder()
	            .postTitle(postTitle)
	            .postContent(postContent)
	            .build();
	    
	    int result = 1; // 테스트를 위해 1로 고정
	    
	    String msg, loc;
	    if (result>0) {
	        msg = "게시글 등록 성공!";
	        loc = "/board/allboard";  // 경로 수정
	    } else {
	        msg = "게시글 등록 실패";
	        loc = "/post/uploadpost2";  // 경로 수정
	    }
	    request.setAttribute("msg", msg);
	    request.setAttribute("loc", loc);
	    
	    // 테스트를 위해 바로 편집기 페이지로 이동
	    request.getRequestDispatcher("/WEB-INF/views/post/uploadPost2.jsp").forward(request, response);
	}

	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		doGet(request, response);
	}

}

```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/controller/post/ViewPostServlet.java
```java
package com.ttt.controller.post;

import java.io.File;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.ttt.dto.Post1;
import com.ttt.service.PostService;

@WebServlet("/post/viewpost")
public class ViewPostServlet extends HttpServlet {
	private static final long serialVersionUID = 1L;
    public ViewPostServlet() {
        super();
    }
	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		int postNo = Integer.parseInt(request.getParameter("postNo"));
		
		Cookie[] cookies = request.getCookies();
		String readPost = "";
		boolean readResult = false;
		if(cookies!=null) {
			for(Cookie c : cookies) {
				if(c.getName().equals("readPost")) {
					readPost = c.getValue();
					if(c.getValue().contains("|" + postNo + "|")) {
						readResult = true;
					}
				}
			}
		}
		if(!readResult) {
			Cookie c = new Cookie("readPost", readPost + "|" +postNo + "|");
			c.setPath(request.getContextPath());
			c.setMaxAge(60*60*24);
			response.addCookie(c);
		}
		
		Post1 p = new PostService().selectBoardJoinCommentJoinMember(postNo);
		
		request.setAttribute("post", p);
		request.getRequestDispatcher("/WEB-INF/views/post/viewPost.jsp").forward(request, response);
	}
	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		doGet(request, response);
	}

}

```



# 디렉토리: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/dao

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/dao/BoardDao.java
```java
package com.ttt.dao;

import java.util.List;
import java.util.Map;

import org.apache.ibatis.session.RowBounds;
import org.apache.ibatis.session.SqlSession;

import com.ttt.dto.Post1;

public class BoardDao {
	
	public List<Post1> selectIndexPageBoardListByCategoryNo(SqlSession session, int categoryNo){
		return session.selectList("board.selectIndexPageBoardListByCategoryNo",categoryNo);
	}
	
	// cPage값과 numPerPage 값을 이용해 페이징처리를 위한 RowBounds 객체 생성
	public List<Post1> selectBoardListAllCategory(SqlSession session, Map<String, Integer> param){
		
		int cPage=param.get("cPage");
		int numPerPage=param.get("numPerPage");

		RowBounds rb=new RowBounds((cPage-1)*numPerPage,numPerPage);
		return session.selectList("board.selectBoardListAllCategory",null,rb);
	}
	
	// cPage값과 numPerPage 값을 이용해 페이징처리를 위한 RowBounds 객체 생성 및 categoryNo mapper 로 넘겨주기
	public List<Post1> selectBoardListByCategoryNo(SqlSession session, Map<String, Integer> param){
		
		int cPage=param.get("cPage");
		int numPerPage=param.get("numPerPage");
		int categoryNo=param.get("categoryNo"); // mapper 에는 categoyNo 만 전달 

		RowBounds rb=new RowBounds((cPage-1)*numPerPage,numPerPage);
		return session.selectList("board.selectBoardListAllCategory",categoryNo,rb);
	}

	// 쿼리문을 실행키셔 totalData 값(int)을 받아오는 view
	public int selectBoardCountAll(SqlSession session) {
		return session.selectOne("board.selectBoardCountAll");
	}
		
	// 쿼리문을 실행키셔 totalData 값(int)을 받아오는 view
	public int selectBoardCountByCategoryNo(SqlSession session, int categoryNo) {
		return session.selectOne("board.selectBoardCountByCategoryNo",categoryNo);
	}
	
	//내가 작성한 글을 가져오기 위한 쿼리문을 실행시킬 함수
	public List<Post1> selectBoardListByMemberNo(SqlSession session, Map<String,Integer> param){

		int cPage=param.get("cPage");
		int numPerPage=param.get("numPerPage");
		int memberNo=param.get("memberNo"); // mapper 에는 categoyNo 만 전달 

		RowBounds rb=new RowBounds((cPage-1)*numPerPage,numPerPage);
		return session.selectList("board.selectBoardListByMemberNo",memberNo,rb);
	}
	public int selectBoardCountByMemberNo(SqlSession session, int memberNo) {
		return session.selectOne("board.selectBoardCountByMemberNo",memberNo);
	}
	
}

```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/dao/MemberDao.java
```java
package com.ttt.dao;

import org.apache.ibatis.session.SqlSession;

import com.ttt.dto.Member1;

/* MemberService 클래스로부터 session 을 넘겨받아 실행시킬 쿼리문을 함수로 만들어 결과를 반환하는 클래스 */
public class MemberDao {

	public int insertMember(SqlSession session, Member1 m) {
		return session.insert("member.insertMember",m);
	}
	
	public Member1 selectMemberById(SqlSession session, String email) {
		return session.selectOne("member.selectMemberById",email);
	}
	
	public Member1 selectMemberByNameAndEmail(SqlSession session, Member1 m) {
		return session.selectOne("member.selectMemberByNameAndEmail",m);
	}
	
	public int updatePassword(SqlSession session, Member1 m) {
		return session.update("member.updatePassword", m);
	}
	public int updateMember(SqlSession session, Member1 m) {
		return session.update("member.updateMember", m);
	}
}

```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/dao/PostDao.java
```java
package com.ttt.dao;

import java.util.List;

import org.apache.ibatis.session.SqlSession;

import com.ttt.dto.Image1;
import com.ttt.dto.Post1;

public class PostDao {
	public int uploadPost(SqlSession session, Post1 p) {
		return session.insert("post.insertPost",p);
	}
	public List<Image1> selectImgAll(SqlSession session) {
		return session.selectList("post.selectImgAll");
	}
	public int insertPost(SqlSession session, Post1 p) {
		return session.insert("post.insertPost", p);
	}
	public Post1 selectBoardJoinCommentJoinMember(SqlSession session, int postNo) {
		return session.selectOne("post.selectBoardJoinCommentJoinMember", postNo);
	}
	
	// savePostWithImages 서비스 이용을 위해 재사용
	public int insertPostAndGetNo(SqlSession session, Post1 post) {
		int result = session.insert("post.insertPost", post);
	    if(result <= 0) {
	        throw new RuntimeException("게시글 저장 실패"); // 저장 실패한 경우를 처리해줘야함. 반환값이 0이되면 안됨.
	    }
	    return post.getPostNo();
	}
	public int insertPostImage(SqlSession session, Image1 image) {
		return session.insert("post.insertPostImage", image);
	}
}

```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/dao/SchoolDao.java
```java
package com.ttt.dao;

import java.util.List;
import java.util.Map;

import org.apache.ibatis.session.SqlSession;

import com.ttt.dto.School12;

/* 서비스 클래스로부터 session 을 넘겨받아 쿼리문을 실행하는 클래스 */
public class SchoolDao {
	
	public List<School12> selectNameAndCode(SqlSession session, Map<String,Object> inputSchoolInfo){
		System.out.println(inputSchoolInfo);
		return session.selectList("school.selectNameAndCode",inputSchoolInfo);
	}
	
	public School12 selectSchoolInfoBySchoolNo(SqlSession session, int schoolNo) {
		return session.selectOne("school.selectSchoolInfoBySchoolNo",schoolNo);
	}
}

```


# 디렉토리: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/dto

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/dto/AuthenticationResult.java
```java
package com.ttt.dto;

import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;

//인증 결과를 담을 클래스
@Data
@AllArgsConstructor
@NoArgsConstructor
@Builder
public class AuthenticationResult {

    private boolean success;
    private String message;
}

```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/dto/Comment1.java
```java
package com.ttt.dto;

import java.sql.Date;

import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;

@Data
@NoArgsConstructor
@AllArgsConstructor
@Builder
public class Comment1 {
	private int commentNo;
	private int parentNo;
	private String comment;
	private Date createDate;
	private Date updateDate;
	private int level;
	private Member1 member;
	private Post1 post;

}

```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/dto/Image1.java
```java
package com.ttt.dto;

import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;

@Data
@NoArgsConstructor
@AllArgsConstructor
@Builder
public class Image1 {
	private int imgNo;
	private int imgSeq;
	private String oriname;
	private String renamed;
	private int postNo;
}

```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/dto/Like1.java
```java
package com.ttt.dto;

public class Like1 {
	private Member1 member;
	private Post1 post;

}

```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/dto/Member1.java
```java
package com.ttt.dto;

import java.sql.Date;

import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;

@Data
@AllArgsConstructor
@NoArgsConstructor
@Builder
public class Member1 {
	private int memberNo;
	private String memberName;
	private String email;
	private String memberPw;
	private String memberNick; // 닉네임 중복시 뒤에 번호 추가하는건 어떤지 의논해보기(자동부여)
	private int memberType; // 관리자:0 학부모:1 교사:2
	private School12 childSchool; // 자녀중 한명의 학교 표준 코드를 저장
	private Date enrollDate;
}

```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/dto/Post1.java
```java
package com.ttt.dto;

import java.sql.Date;
import java.util.ArrayList;
import java.util.List;

import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;

@Data
@NoArgsConstructor
@AllArgsConstructor
@Builder
public class Post1 {
	private int categoryNo;
	private int postNo;
	private Member1 member;
	private String postTitle;
	private String postContent;
	private int viewCount;
	private int likeCount;
	private Date createDate;
	private Date updateDate;
	private int status;
	private int isPublic;
	private int isNotice;
	private int commentCount;
	private List<Image1> images;
	private School12 school;
	private List<Comment1> comments;
}

```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/dto/School12.java
```java
package com.ttt.dto;

import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;

@Data
@AllArgsConstructor
@NoArgsConstructor
@Builder
public class School12 {
	private int schoolNo; /* 키값으로 사용하기 위해 새로 부여해준 번호 */
	private String region;
	private String district;
	private String schoolName;
	private int schoolType; /* 1:초등학교 2:중학교 3:고등학교 4:기타학교 */ 
	private String regionCode; /* 지역 교육청 표준 코드 */
	private int standardCode; /* 학교 표준 코드 중복되는 경우가 있음 */

}

```


# 디렉토리: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/service

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/service/BoardService.java
```java
package com.ttt.service;

import static com.ttt.common.SqlSessionTemplate.getSession;

import java.util.List;
import java.util.Map;

import org.apache.ibatis.session.SqlSession;

import com.ttt.dao.BoardDao;
import com.ttt.dto.Post1;

public class BoardService {
	
	private BoardDao dao=new BoardDao();

	// categotyNo 값을 받아서 index.jsp 의 각 섹션에 맞는 글 목록을 view 해주는 서비스
	public List<Post1> selectIndexPageBoardListByCategoryNo(int categoryNo){
		SqlSession session=getSession();
		return dao.selectIndexPageBoardListByCategoryNo(session, categoryNo);
	}
	
	//cPage, numPerPage 값을 받아서 해당 카테고리에 맞는 글 목록을 view 해주는 서비스
	public List<Post1> selectBoardListAllCategory(Map<String, Integer> param){
		SqlSession session=getSession();
		return dao.selectBoardListAllCategory(session, param);
	}

	// categotyNo, cPage, numPerPage 값을 받아서 해당 카테고리에 맞는 글 목록을 view 해주는 서비스
	public List<Post1> selectBoardListByCategoryNo(Map<String, Integer> param){
		SqlSession session=getSession();
		return dao.selectBoardListAllCategory(session, param);
	}
	
	// (totalData) 카테고리별 게시글 수를 확인시켜주는 서비스
	public int selectBoardCountAll() {
		SqlSession session=getSession();
		return dao.selectBoardCountAll(session);
	}
	
	// (totalData) 전체 게시글 수를 확인시켜주는 서비스
	public int selectBoardCountByCategoryNo(int categoryNo) {
		SqlSession session=getSession();
		return dao.selectBoardCountByCategoryNo(session, categoryNo);
	}
	
	// 내가 작성한 글 리스트를 가져오기 위해 DB와 통신하는 서비스
	public List<Post1> selectBoardListByMemberNo(Map<String,Integer> param){
		SqlSession session=getSession();
		return dao.selectBoardListByMemberNo(session, param);
	}
	// (totalData) 내가 작성한 글 전체 게시글 수 확인
	public int selectBoardCountByMemberNo(int memberNo) {
		SqlSession session=getSession();
		return dao.selectBoardCountByMemberNo(session, memberNo);
	}
	
	
}

```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/service/EmailAuthenticationService.java
```java
package com.ttt.service;

import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import java.util.Base64;
import java.util.Random;

import javax.mail.MessagingException;
import javax.servlet.http.HttpSession;

import com.ttt.dto.AuthenticationResult;

public class EmailAuthenticationService {
    private static final int AUTH_NUMBER_LENGTH = 6;
    private static final int MAX_ATTEMPTS = 5;
    private static final int EXPIRY_MINUTES = 5;

    // 인증번호 생성
    public String generateAuthNumber() {
        Random random = new Random();
        StringBuilder builder = new StringBuilder();
        for (int i = 0; i < AUTH_NUMBER_LENGTH; i++) {
            builder.append(random.nextInt(10));
        }
        return builder.toString();
    }

    // 인증번호 해시화
    public String hashAuthNumber(String authNumber) {
        try {
            MessageDigest md = MessageDigest.getInstance("SHA-512");
            byte[] bytes = authNumber.getBytes();
            md.update(bytes);
            byte[] digest = md.digest();
            return Base64.getEncoder().encodeToString(digest);
        } catch(NoSuchAlgorithmException e) {
            throw new RuntimeException("해시 알고리즘 오류", e);
        }
    }

    // 이메일 전송
    public void sendAuthEmail(String email, String authNumber) 
        throws MessagingException {
        EmailSenderService sender = new EmailSenderService();
        String subject = "이메일 인증번호";
        String content = "인증번호는 [" + authNumber + "] 입니다.";
        sender.sendEmail(email, subject, content);
    }

    // 세션에 인증 정보 저장
    public void setAuthenticationInfo(HttpSession session, String email, 
        String hashedAuthNumber) {
        session.setAttribute("hashedAuthNumber", hashedAuthNumber);
        session.setAttribute("authCreateTime", System.currentTimeMillis());
        session.setAttribute("email", email);
        session.setAttribute("failCount", 0);
        session.setMaxInactiveInterval(EXPIRY_MINUTES * 60);
    }

    // 인증번호 검증
    public AuthenticationResult verifyAuthNumber(HttpSession session, 
        String inputAuthNumber) {
        Long authCreateTime = (Long) session.getAttribute("authCreateTime");
        Integer failCount = (Integer) session.getAttribute("failCount");
        String hashedAuthNumber = (String) session.getAttribute("hashedAuthNumber");

        if (authCreateTime == null || hashedAuthNumber == null) {
            return new AuthenticationResult(false, "인증 정보가 없습니다.");
        }

        // 만료 시간 체크
        if (System.currentTimeMillis() - authCreateTime > 
            EXPIRY_MINUTES * 60 * 1000) {
            clearAuthenticationInfo(session);
            return new AuthenticationResult(false, "인증번호가 만료되었습니다.");
        }

        // 실패 횟수 체크
        if (failCount != null && failCount >= MAX_ATTEMPTS) {
            clearAuthenticationInfo(session);
            return new AuthenticationResult(false, "인증 시도 횟수를 초과했습니다.");
        }

        // 인증번호 검증
        String hashedInput = hashAuthNumber(inputAuthNumber);
        if (hashedAuthNumber.equals(hashedInput)) {
            return new AuthenticationResult(true, "인증이 완료되었습니다.");
        } else {
            session.setAttribute("failCount", 
                (failCount == null ? 1 : failCount + 1));
            return new AuthenticationResult(false, "인증번호가 일치하지 않습니다.");
        }
    }

    // 세션 정보 초기화
    public void clearAuthenticationInfo(HttpSession session) {
        session.removeAttribute("hashedAuthNumber");
        session.removeAttribute("authCreateTime");
        session.removeAttribute("failCount");
        session.removeAttribute("email");
    }

}

```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/service/EmailSenderService.java
```java
package com.ttt.service;

import java.io.FileInputStream;
import java.io.IOException;
import java.util.Properties;

import javax.mail.Authenticator;
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.PasswordAuthentication;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;

// 이메일 정보를 호출해서 메일을 보내주는 서비스, 실제 이메일 전송을 담당하는 서비스 클래스 (SMTP 설정 및 메일 발송 처리)
public class EmailSenderService {
    private Properties emailProps;

    public EmailSenderService() {
        loadProperties();
    }

    //email.properties 에 보안 정보 저장해서 호출해서 사용하기
    private void loadProperties() {
        try {
            emailProps = new Properties();
            String path = EmailSenderService.class.getResource("/email.properties").getPath();
            emailProps.load(new FileInputStream(path));
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
    
    public void sendEmail(String to, String subject, String content) throws MessagingException {
    	Properties props = new Properties();
        props.put("mail.smtp.host", emailProps.getProperty("mail.smtp.host"));
        props.put("mail.smtp.port", emailProps.getProperty("mail.smtp.port"));
        props.put("mail.smtp.auth", emailProps.getProperty("mail.smtp.auth"));
        props.put("mail.smtp.starttls.enable", emailProps.getProperty("mail.smtp.starttls.enable"));

        Session session = Session.getInstance(props, new Authenticator() {
            @Override
            protected PasswordAuthentication getPasswordAuthentication() {
                return new PasswordAuthentication(
                    emailProps.getProperty("mail.username"),
                    emailProps.getProperty("mail.password")
                );
            }
        });

        Message message = new MimeMessage(session);
        message.setFrom(new InternetAddress(emailProps.getProperty("mail.username")));
        message.setRecipients(Message.RecipientType.TO, InternetAddress.parse(to));
        message.setSubject(subject);
        message.setText(content);

        Transport.send(message);
    }

}

```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/service/MemberService.java
```java
package com.ttt.service;

import static com.ttt.common.SqlSessionTemplate.getSession;

import org.apache.ibatis.session.SqlSession;

import com.ttt.dao.MemberDao;
import com.ttt.dto.Member1;

/* Connection 과 MemberDao 객체를 만들어서 서버와 db 서버가 서로 통신할 수 있게 서비스를 제공하는 클래스 */
public class MemberService {
	
	private MemberDao dao=new MemberDao();
	
	public int insertMember(Member1 m) {
		SqlSession session=getSession();
	    int result = 0;
	    try {
	        result = dao.insertMember(session, m);
	        if(result > 0) {
	            session.commit();
	        } else {
	            session.rollback();
	        }
	    } catch(Exception e) {
	        e.printStackTrace();
	        session.rollback();
	        throw e;
	    } finally {
	        session.close();
	    }
		return result;
	}
	
	public Member1 selectMemberById(String email) {
		SqlSession session=getSession();
		return dao.selectMemberById(session, email);
	}
	
	public Member1 selectMemberByNameAndEmail(Member1 m) {
		SqlSession session=getSession();
		return dao.selectMemberByNameAndEmail(session, m);
	}
	
	public int updatePassword(Member1 m) {
		SqlSession session=getSession();
	    int result = 0;
	    try {
	        result = dao.updatePassword(session, m);
	        if(result > 0) session.commit();
	        else session.rollback();
	    } catch(Exception e) {
	        session.rollback();
	        throw e;
	    } finally {
	        session.close();
	    }
	    return result;
	}
	public int updateMember(Member1 m) {
		SqlSession session=getSession();
		int result = 0;
		try {
			result = dao.updateMember(session, m);
			if(result > 0) session.commit();
			else session.rollback();
		} catch(Exception e) {
			session.rollback();
			throw e;
		} finally {
			session.close();
		}
		return result;
	}
}

```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/service/PostService.java
```java
package com.ttt.service;

import static com.ttt.common.SqlSessionTemplate.getSession;

import java.sql.SQLException;
import java.util.List;

import org.apache.ibatis.session.SqlSession;

import com.ttt.dao.PostDao;
import com.ttt.dto.Image1;
import com.ttt.dto.Post1;

public class PostService {
	private PostDao dao = new PostDao();
	
	public int uploadPost(Post1 p) {
		SqlSession session = getSession();
		int result = dao.uploadPost(session, p);
		if (result>0) session.commit();
		else session.rollback();
		
		session.close();
		return result;
	}
	public List<Image1> selectImgAll() {
		SqlSession session = getSession();
		List<Image1> childImgs = dao.selectImgAll(session);
		session.close();
		return childImgs;
	}
	public Post1 insertPost(Post1 post, List<Image1> images) {
		SqlSession session = getSession();
		try {
			//1. 게시글 저장하고 번호 받아오기 
			int postNo = dao.insertPostAndGetNo(session, post);
            post.setPostNo(postNo);
            
            // 2. 이미지가 있으면 이미지 정보 저장
            if(images != null && !images.isEmpty()) {
                for(Image1 image : images) {
                    image.setPostNo(postNo);
                    dao.insertPostImage(session, image);
                }
            }
            session.commit();
            return post;
		} catch(Exception e) {
			session.rollback();
			throw e;
		} finally {
			session.close();
		}
	}
	public Post1 selectBoardJoinCommentJoinMember (int postNo) {
		SqlSession session = getSession();
		Post1 p = dao.selectBoardJoinCommentJoinMember(session, postNo);
		session.close();
		return p;
	}
	
//	public Post1 insertPostAndGetNo(Post1 post) {
//		SqlSession session = getSession();
//		try {
//			int result = dao.insertPost(session, post);
//			if(result > 0) {
//				int postNo = dao.selectLastPostNo(session);
//				post.setPostNo(postNo);
//				session.commit();
//			}
//			return post;
//		} catch(Exception e) {
//			session.rollback();
//			e.printStackTrace();
//		} finally {
//			session.close();
//		}
//	}
	
	// Post1 과 Image1을 동시에 저장하기 위한 트랜잭션관리 (postNo를 받아와서 image 저장 관리)
	public Post1 savePostWithImages(Post1 post, List<Image1> images) {
        SqlSession session = null;
        try {
            session = getSession();
            // 트랜잭션 시작 - autocommit false
            session.getConnection().setAutoCommit(false);

            // 1. 게시글 저장 및 번호 받아오기 
            int postNo = dao.insertPostAndGetNo(session, post);  // 실패시 예외 발생
            post.setPostNo(postNo);
            
            // 2. 이미지가 있으면 이미지 정보(객체)에 postNo set 해주기!
            if(images != null && !images.isEmpty()) {
                for(Image1 image : images) {
                    image.setPostNo(postNo);
                    int result = dao.insertPostImage(session, image);
                    if(result <= 0) {
                        throw new RuntimeException("이미지 저장 실패"); // (1) 여기서 예외 발생
                    }
                }
            }
            
            // 모든 작업이 성공하면 커밋
            session.commit();
            return post;

        } catch(Exception e) { // (2) 위에서 발생한 RuntimeException은 여기서 캐치
            // 실패시 롤백
            if(session != null) session.rollback(); // (3) 롤백 처리
            throw new RuntimeException("게시글 저장 중 오류 발생", e); // (4) 새로운 예외로 감싸서 던짐 - 필요한지 검토해보기.
        } finally {
            // 세션 종료
            if(session != null) {
                try {
                    session.getConnection().setAutoCommit(true); // autocommit 상태 복구
                    session.close();
                } catch(SQLException e) {
                    e.printStackTrace();
                }
            }
        }
    }
}

```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/java/com/ttt/service/SchoolService.java
```java
package com.ttt.service;

import static com.ttt.common.SqlSessionTemplate.getSession;

import java.util.List;
import java.util.Map;

import org.apache.ibatis.session.SqlSession;

import com.ttt.dao.SchoolDao;
import com.ttt.dto.School12;

/* Connection 과 dao 객체를 만들어서 서버와 db 서버가 서로 통신할 수 있게 서비스를 제공하는 클래스 */
public class SchoolService {

	private SchoolDao dao=new SchoolDao();
	
	public List<School12> selectNameAndCode(Map<String,Object> inputSchoolInfo) {
		SqlSession session=getSession();
		List<School12> result=dao.selectNameAndCode(session,inputSchoolInfo);
		session.close();
		return result;
		
	}
	
	public School12 selectSchoolInfoBySchoolNo(int schoolNo) {
		SqlSession session=getSession();
		return dao.selectSchoolInfoBySchoolNo(session,schoolNo);
		
	}

}

```





# 디렉토리: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/resources

# 디렉토리: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/resources/mappers

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/resources/mappers/board-mapper.xml
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="board">
	
	<select id="selectIndexPageBoardListByCategoryNo" parameterType="_int" resultMap="post.postMap">
		SELECT *
		FROM (
			SELECT POST_NO, POST_TITLE, LIKE_COUNT, COMMENT_COUNT
			FROM POST1 
			WHERE CATEGORY_NO=#{categoryNo}
				AND IS_PUBLIC=1
			ORDER BY CREATE_DATE DESC 
		)
		WHERE 10 >= ROWNUM
	</select>
	
	<!-- 카테고리에 상관없이 모든 게시판 글 출력하기( -->
	<select id="selectBoardListAllCategory" parameterType="_int" resultMap="post.postMap">
		SELECT *
		FROM (
			SELECT POST_NO, CATEGORY_NO, POST_TITLE, LIKE_COUNT, M1.MEMBER_NICK AS POST_MEMBER_NICK, COMMENT_COUNT, VIEW_COUNT, CREATE_DATE
			FROM 
				POST1 P
			LEFT JOIN
				MEMBER1 M1 ON P.MEMBER_NO=M1.MEMBER_NO
			WHERE 
				IS_PUBLIC=1
				AND CATEGORY_NO NOT IN (1,3)
			ORDER BY CREATE_DATE DESC 
		)
		WHERE 10 >= ROWNUM
	</select>
	
	<!-- param으로 DAO까지는 cPage값과 numPerPage 값을 받아온 후 mapper에는 categoryNo만 넘겨주기 -->
	<select id="selectBoardListByCategoryNo" parameterType="_int" resultMap="post.postMap">
		SELECT *
		FROM (
			SELECT POST_NO, POST_TITLE, LIKE_COUNT, M1.MEMBER_NICK AS POST_MEMBER_NICK, COMMENT_COUNT, VIEW_COUNT, CREATE_DATE
			FROM 
				POST1 P
			LEFT JOIN
				MEMBER1 M1 ON P.MEMBER_NO=M1.MEMBER_NO
			WHERE 
				IS_PUBLIC=1
				AND CATEGORY_NO=#{categoryNo}
			ORDER BY CREATE_DATE DESC 
		)
	</select>
	
	
	<select id="selectBoardCountAll" resultType="_int">
		SELECT COUNT(*)
		FROM POST1
		WHERE 
			IS_PUBLIC=1
			AND CATEGORY_NO NOT IN (1,3)
	</select>
	
	
	<select id="selectBoardCountByCategoryNo" parameterType="_int" resultType="_int">
		SELECT COUNT(*)
		FROM POST1
		WHERE 
			IS_PUBLIC=1
			AND CATEGORY_NO=#{categoryNo}
	</select>
	
	<select id="selectBoardListByMemberNo" parameterType="_int" resultMap="post.postMap">
		SELECT *
		FROM (
			SELECT POST_NO, POST_TITLE, LIKE_COUNT, M1.MEMBER_NICK AS POST_MEMBER_NICK, COMMENT_COUNT, VIEW_COUNT, CREATE_DATE
			FROM 
				POST1 P
			LEFT JOIN
				MEMBER1 M1 ON P.MEMBER_NO=M1.MEMBER_NO
			WHERE 
				MEMBER_NO=#{memberNo}
				AND IS_PUBLIC=1
			ORDER BY CREATE_DATE DESC 
		)
	</select>
	<select id="selectBoardCountByMemberNo" parameterType="_int" resultType="_int">
		SELECT COUNT(*)
		FROM POST1
		WHERE 
			MEMBER_NO=#{memberNo}
			AND IS_PUBLIC=1
	</select>
	
</mapper>
```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/resources/mappers/image-mapper.xml
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="image">
	<resultMap id="imageMap" type="image1">
		<id column="imgNo" property="imgNo"/>
		<result column="img_seq" property="imgSeq"/>
		<result column="oriname" property="oriname"/>
		<result column="renamed" property="renamed"/>
	</resultMap>


</mapper>
```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/resources/mappers/member-mapper.xml
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="member">

	<!-- school12 타입과 연결시켜주기 DB 컬럼명을 연결시켜주기 위한 resultMap. config에 type명 선언해서 사용 -->
	<resultMap id="memberMap" type="member1">
		<id column="member_no" property="memberNo"/>
		<result column="member_name" property="memberName"/>
		<result column="email" property="email"/>
		<result column="member_pw" property="memberPw"/>
		<result column="member_nick" property="memberNick"/>
		<result column="member_type" property="memberType"/>
		<result column="school_no" property="childSchool.schoolNo"/> <!-- 현재 입력받는 정보는 학교 고유 코드를 저장하게 됨...-->
		<result column="enroll_date" property="enrollDate"/>
	</resultMap>

	
	<insert id="insertMember" parameterType="member1">
	    INSERT INTO MEMBER1 (
	        MEMBER_NO,
	        MEMBER_NAME,
	        EMAIL,
	        MEMBER_PW,
	        MEMBER_NICK,
	        MEMBER_TYPE,
	        SCHOOL_NO,
	        ENROLL_DATE
	    ) VALUES (
	        MEMBER_SEQ.NEXTVAL,
	        #{memberName},
	        #{email},
	        #{memberPw},
	        #{memberNick},
	        #{memberType},
	        #{childSchool.schoolNo},  <!--매개변수 타입 선언에 의해 childSchool 객체-->
	        SYSDATE
	    )
	</insert>   
	
	<select id="selectMemberById" parameterType="string" resultMap="memberMap">
		SELECT * FROM MEMBER1 WHERE EMAIL=#{email}
	</select>
	
	<select id="selectMemberByNameAndEmail" parameterType="member1" resultMap="memberMap">
		SELECT * FROM MEMBER1 WHERE EMAIL=#{email} AND MEMBER_NAME=#{memberName}
	</select>
	
	<update id="updatePassword" parameterType="member1">
		UPDATE MEMBER1 SET 
			member_pw=#{memberPw}
			WHERE email=#{email}
	
	</update>
	<update id="updateMember" parameterType="member1">
		UPDATE MEMBER1 SET
			MEMBER_NAME=#{memberName}, EMAIL=#{email}, MEMBER_PW=#{memberPw}, MEMBER_NICK=#{memberNick} WHERE EMAIL=#{email}			
	</update>
</mapper>
```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/resources/mappers/post-mapper.xml
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="post">
	<resultMap id="postCommentMap" type="comment1">
		<id column="comment_no" property="commentNo"/>
		<result column="parent_no" property="parentNo"/>
		<result column="comment_contnet" property="comment"/>
		<result column="create_date" property="createDate"/>
		<result column="update_date" property="updateDate"/>
		<result column="comment_level" property="level"/>
		<association property="member" javaType="member1">
			<id column="member_no" property="memberNo"/>
			<result column="member_name" property="memberName"/>
			<result column="email" property="email"/>
			<result column="member_pw" property="memberPw"/>
			<result column="comment_member_nick" property="memberNick"/>
			<result column="member_type" property="memberType"/>
			<result column="school_no" property="childSchool.schoolNo"/> <!-- 현재 입력받는 정보는 학교 고유 코드를 저장하게 됨...-->
			<result column="enroll_date" property="enrollDate"/>
		</association>
		<association property="post" resultMap="postMap"/>
	</resultMap>
	<resultMap id="postMap" type="post1">
		<id column="post_no" property="postNo"/>
		<result column="category_no" property="categoryNo"/>
		<result column="post_title" property="postTitle"/>
		<result column="post_content" property="postContent"/>
		<result column="view_count" property="viewCount"/>
		<result column="like_count" property="likeCount"/>
		<result column="create_date" property="createDate"/>
		<result column="update_date" property="updateDate"/>
		<result column="status" property="status"/>
		<result column="is_public" property="isPublic"/>
		<result column="is_Notice" property="isNotice"/>
		<result column="comment_count" property="commentCount"/>
		<association property="member" javaType="member1">
			<id column="member_no" property="memberNo"/>
			<result column="member_name" property="memberName"/>
			<result column="email" property="email"/>
			<result column="member_pw" property="memberPw"/>
			<result column="post_member_nick" property="memberNick"/>
			<result column="member_type" property="memberType"/>
			<result column="school_no" property="childSchool.schoolNo"/> <!-- 현재 입력받는 정보는 학교 고유 코드를 저장하게 됨...-->
			<result column="enroll_date" property="enrollDate"/>
		</association>
		<association property="school" resultMap="school.schoolMap"/>
		<collection property="images" resultMap="image.imageMap"/>
		<collection property="comments" resultMap="postCommentMap"/>
	</resultMap>
	
	<select id="selectRegion" resultType="string">
		SELECT DISTINCT REGION FROM SCHOOL12
	</select>
	
	<select id="selectDistrict" parameterType="string" resultType="string">
		SELECT DISTINCT DISTRICT
		FROM SCHOOL12
		WHERE REGION LIKE
		CASE #{region}
			WHEN '서울' THEN '서울%'
			WHEN '경기' THEN '경기%'
			WHEN '인천' THEN '인천%'
			WHEN '부산' THEN '부산%'
			WHEN '세종' THEN '세종%'
			WHEN '광주' THEN '광주%'
			WHEN '대구' THEN '대구%'
			WHEN '대전' THEN '대전%'
			WHEN '울산' THEN '울산%'
			WHEN '강원' THEN '강원%'
			WHEN '충남' THEN '충청남도'
			WHEN '충북' THEN '충청북도'
			WHEN '경남' THEN '경상남도'
			WHEN '경북' THEN '경상북도'
			WHEN '전남' THEN '전라남도'
			WHEN '전북' THEN '전%북%'
			WHEN '제주' THEN '제주%'
		END
		ORDER BY DISTRICT
	</select>
	
	<select id="selectSchool" parameterType="string" resultType="string">
		SELECT DISTINCT SCHOOL_NAME
		FROM SCHOOL12
		WHERE DISTRICT = #{district}
		AND SCHOOL_NAME LIKE '%' || #{schoolName}
		ORDER BY SCHOOL_NAME
	</select>
	
	<select id="selectImgAll" resultMap="image.imageMap">
		SELECT * FROM IMAGE1
	</select>
	
<!-- 	<insert id="insertPost" parameterType="post1">
		INSERT INTO POST1 (
			POST_NO,
			POST_TITLE,
			POST_CONTENT,
			CREATE_DATE,
			MEMBER_NO,
			CATEGORY_NO
		) VALUES (
			POST_SEQ.NEXTVAL, 
			#{postTitle}, 
			#{postContent},
			SYSDATE,
			#{m.memberNo},
			#{categoryNo}
		)
	</insert> -->
	
	<select id="selectBoardJoinCommentJoinMember" parameterType="_int" resultMap="postMap">
		SELECT 
		    P.*,
		    M1.MEMBER_NICK AS POST_MEMBER_NICK,
		    C.COMMENT_NO,
		    C.PARENT_NO,
		    C.COMMENT_CONTENT,
		    C.CREATE_DATE AS COMMENT_CREATE_DATE,
		    C.UPDATE_DATE AS COMMENT_UPDATE_DATE,
		    C.COMMENT_LEVEL,
		    C.MEMBER_NO AS COMMENT_MEMBER_NO,
		    C.POST_NO AS COMMENT_POST_NO,
		    M2.MEMBER_NICK AS COMMENT_MEMBER_NICK
		FROM 
		    POST1 P
		LEFT JOIN 
		    MEMBER1 M1 ON P.MEMBER_NO = M1.MEMBER_NO
		LEFT JOIN 
		    COMMENT1 C ON P.POST_NO = C.POST_NO
		LEFT JOIN 
		    MEMBER1 M2 ON C.MEMBER_NO = M2.MEMBER_NO
		WHERE 
		    P.POST_NO = #{postNo}
		ORDER BY 
		    P.POST_NO, C.COMMENT_NO
	</select>
	
	<insert id="insertPost" parameterType="post1">
		<selectKey keyProperty="postNo" resultType="int" order="BEFORE">
			SELECT POST_SEQ.NEXTVAL FROM DUAL
		</selectKey>
		INSERT INTO POST1 (
			POST_NO, <!-- /* 여기에 위에서 얻은 시퀀스 값이 들어감 */ -->
			POST_TITLE,
			POST_CONTENT,
			MEMBER_NO,
			CATEGORY_NO,
			CREATE_DATE
		) VALUES (
			#{postNo}, <!-- /* selectKey에서 설정된 값 사용 */ -->
			#{postTitle},
			#{postContent},
			#{member.memberNo},
			#{categoryNo},
			SYSDATE
		)
	</insert>
	
	<insert id="insertPostImage" parameterType="image1">
		INSERT INTO IMAGE1 (
            IMG_NO,
            IMG_SEQ,
            ORINAME,
            RENAMED,
            POST_NO
        ) VALUES (
            SEQ_IMAGE_NO.NEXTVAL,
            #{imgSeq},
            #{oriname},
            #{renamed},
            #{postNo}
        )
	</insert>
</mapper>
```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/resources/mappers/school-mapper.xml
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="school">

	<!-- school12 타입과 연결시켜주기 DB 컬럼명을 연결시켜주기 위한 resultMap. config에 type명 선언해서 사용 -->
	<resultMap id="schoolMap" type="school12">
		<id column="school_no" property="schoolNo"/>
		<result column="region" property="region"/>
		<result column="district" property="district"/>
		<result column="school_name" property="schoolName"/>
		<result column="school_type" property="schoolType"/>
		<result column="region_code" property="regionCode"/>
		<result column="standard_code" property="standardCode"/>
	</resultMap>

	<select id="selectRegion" resultType="string">
		SELECT DISTINCT REGION FROM SCHOOL12
	</select>
	
	<select id="selectDistrict" parameterType="string" resultType="string">
		SELECT DISTINCT DISTRICT
		FROM SCHOOL12
		WHERE REGION LIKE
		CASE #{region}
			WHEN '서울' THEN '서울%'
			WHEN '경기' THEN '경기%'
			WHEN '인천' THEN '인천%'
			WHEN '부산' THEN '부산%'
			WHEN '세종' THEN '세종%'
			WHEN '광주' THEN '광주%'
			WHEN '대구' THEN '대구%'
			WHEN '대전' THEN '대전%'
			WHEN '울산' THEN '울산%'
			WHEN '강원' THEN '강원%'
			WHEN '충남' THEN '충청남도'
			WHEN '충북' THEN '충청북도'
			WHEN '경남' THEN '경상남도'
			WHEN '경북' THEN '경상북도'
			WHEN '전남' THEN '전라남도'
			WHEN '전북' THEN '전%북%'
			WHEN '제주' THEN '제주%'
		END
		ORDER BY DISTRICT
	</select>
	
	<select id="selectSchool" parameterType="string" resultType="string">
		SELECT DISTINCT SCHOOL_NAME
		FROM SCHOOL12
		WHERE DISTRICT = #{district}
		AND SCHOOL_NAME LIKE '%' || #{schoolType}
		ORDER BY SCHOOL_NAME
	</select>
	
	<!-- 매개변수를 map으로 받아옴. mybatis에 의해 값을 일부만 넣어도 객체로 만들어줌. -->
	<select id="selectNameAndCode" parameterType="map" resultMap="schoolMap">
		SELECT SCHOOL_NO, SCHOOL_NAME, STANDARD_CODE, REGION_CODE
		FROM SCHOOL12
		WHERE DISTRICT = #{district}
		AND SCHOOL_TYPE = #{schoolType}
	</select>
	
	<select id="selectSchoolInfoBySchoolNo" parameterType="_int" resultMap="schoolMap">
		SELECT * FROM SCHOOL12 WHERE SCHOOL_NO=#{schoolNo}
	</select>

</mapper>
```


## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/resources/mybatis-config.xml
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-config.dtd" >
<configuration>
	<!-- configuration 에는 순서가 있음! 태그 순서가 잘못되면 에러가 발생함! -->
	<!-- 민감한 정보 저장해서 불러오기 -->
	<properties resource="/driver.properties"></properties>
	
	
	<!-- DB 접속 환경에 대한 상세 설정, null 값을 넣으면 에러가 나는데 이런 설정을 줄 수 있음 -->
	<settings>
		<!-- 제약조건에 대한 허용이 아님! https://mybatis.org/mybatis-3/configuration.html#settings -->
		<setting name="jdbcTypeForNull" value="NULL"/>
	</settings>
	
	
	<!-- 클래스 타입의 별칭 부여하기 -->
	<typeAliases>
		<typeAlias type="com.ttt.dto.Post1" alias="post1"/>
		<typeAlias type="com.ttt.dto.School12" alias="school12"/>
		<typeAlias type="com.ttt.dto.Member1" alias="member1"/>
		<typeAlias type="com.ttt.dto.Image1" alias="image1"/>
		<typeAlias type="com.ttt.dto.Comment1" alias="comment1"/>
	</typeAliases>
	
	
	<!-- DB정보 작성 : DB 보안 정보는 driver.properties에 개별 작성 -->
	<environments default="teachers">
		<environment id="teachers">
			<transactionManager type="JDBC"/>
			<dataSource type="POOLED">
				<property name="driver" value="${driver}"/>
				<property name="url" value="${url}"/>
				<property name="username" value="${user}"/>
				<property name="password" value="${pw}"/>
			</dataSource>
		</environment>
	</environments>
	
	<!-- 생성한 Mapper 를 전역에서 접근하도록 설정 -->
	<mappers>
		<mapper resource="/mappers/post-mapper.xml"/>
		<mapper resource="/mappers/school-mapper.xml"/>
		<mapper resource="/mappers/member-mapper.xml"/>
		<mapper resource="/mappers/image-mapper.xml"/>
		<mapper resource="/mappers/board-mapper.xml"/>
	</mappers>
	
</configuration>

```


# 디렉토리: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/webapp

# 디렉토리: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/webapp/WEB-INF

# 디렉토리: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/webapp/WEB-INF/lib


# 디렉토리: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/webapp/WEB-INF/views

# 디렉토리: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/webapp/WEB-INF/views/post

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/webapp/WEB-INF/views/post/uploadPost.jsp
```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ page import="java.util.*" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>
<script	src="${pageContext.request.contextPath }/resources/js/jquery-3.7.1.min.js"></script>
<link rel="stylesheet" href="${pageContext.request.contextPath }/resources/css/post/uploadPost.css">
<c:set var="path" value="${pageContext.request.contextPath}" />
<jsp:include page="/WEB-INF/views/common/header.jsp"/>
<jsp:include page="/WEB-INF/views/common/sidebar.jsp"/>
<section class="main-content col-9">
	<div id="post-container" class="col-12">
		<h2>게시글 작성</h2>
	    
	    <div id='board-container'>
	    	<form action='${path }/post/uploadpostend' id="mainForm" method="post" enctype="multipart/form-data" >
	    		<table>
	    			<tr id="category">
	    				<th>카테고리</th>
	    				<td colspan="2">
	    					<select name="categoryNo" id="selector">
	    						<option value="">카테고리 선택</option>
	    						<option value="1">맘스뉴스</option>
	    						<option value="2">고민상담소</option>
	    						<option value="4">초등 게시판</option>
	    						<option value="5">중등 게시판</option>
	    						<option value="6">고등 게시판</option>
	    						<option value="7">고3/n수생 게시판</option>
	    						<option value="8">지역별 게시판</option>
	    						<option value="9">학교별 게시판</option>
	    						<option value="10">자유게시판</option>
	    					</select>
	    				</td>
	    			</tr>
	    			<tr id="region-container" class="hidden">
	    				<td>
	    					<select name="region" id="region" onchange="districtSearch(event);">
								<option value=''>전체지역</option>
								<option value="서울">서울</option>
								<option value="경기">경기</option>
								<option value="인천">인천</option>
								<option value="부산">부산</option>
								<option value="세종">세종</option>
								<option value="광주">광주</option>
								<option value="대구">대구</option>
								<option value="대전">대전</option>
								<option value="울산">울산</option>
								<option value="강원">강원</option>
								<option value="충남">충남</option>
								<option value="충북">충북</option>
								<option value="경남">경남</option>
								<option value="경북">경북</option>
								<option value="전남">전남</option>
								<option value="전북">전북</option>
								<option value="제주">제주</option>
							</select>
	    				</td>
	    				<td>
	    					<select name="district" id="district" onchange="schoolSearch(event);">
	          					<option value=''>구/군</option>
	        				</select>
	    				</td>
	    			</tr>
	    			<tr id="school-container" class="hidden">
	    				<td>
	    					<select id="school-type" onchange="schoolSearch({target:document.getElementById('district')});">
	    						<option value="">초중고</option>
	    						<option value="초등학교">초등학교</option>
	    						<option value="중학교">중학교</option>
	    						<option value="고등학교">고등학교</option>
	    					</select>
	    				<td>
	    					<select name="schoolName" id="school-name">
	          					<option value="">학교명</option>
	        				</select>
	    				</td>
	    			</tr>
	    			<tr>
	    				<th>제목</th>
	    				<td>
	    					<input type="text" name="postTitle"/>
	    				</td>
	    			</tr>
	    			<tr>
	    				<th>작성자</th>
	    				<td>
	    					<input type="text" name="postWriter"
									value="${sessionScope.loginMember.memberName }" readOnly/>
	    				</td>
	    				<td>
	    					<input type="hidden" name="memberNo" 
	    							value="${sessionScope.loginMember.memberNo }"/>
	    				</td>
	    			</tr>
	    			<tr>
	    				<th>첨부파일</th>
	    				<td>
	    					<input type="file" id="upfile" name="upfile" multiple accept="image/*"/>
	    					<div id="preview"></div>
	    				</td>
	    			</tr>
	    			<tr>
	    				<th>내용</th>
	    				<td>
	    					<textarea  rows="10" name="postContent" style="resize:none"></textarea>
	    				</td>
	    			</tr>
	    		</table>
			    <div id="button-container">
			    	<div class="right">
			    		<button name="save">
			    			임시저장
							<input type="hidden" name="saveStatus" value="1"/>
							<input type="hidden" name="savePublic" value="0"/>
			    		</button>
			    		<button name="submit">
			    			등록
							<input type="hidden" name="submitStatus" value="1"/>
							<input type="hidden" name="submitPublic" value="0"/>
			    		</button>
				    </div>
			    </div>
			    <input type="hidden" name="postNo" value="${post.postNo }"/>
	    	</form>
	    </div>
	 </div>

</section>

<script>
	/* 전체지역 선택시 선택값에 맞는 구/군 출력 */
	function districtSearch(e) {
		const select = document.getElementById("district");
		select.innerHTML="<option value=''>구/군</option>";
		const region=e.target.value;
		fetch("${path}/post/district?region=" + region)
			.then(response => response.json())
			.then(data => {
				data.forEach(district => {
					const option = document.createElement("option");
					option.value = district;
					option.textContent = district;
					select.appendChild(option);
				});
			})
			.catch(error => console.error("Error : ",error));
	};
	/* 구/군 및 초중고 선택시, 선택값에 맞는 학교명 출력 */
	function schoolSearch(e) {
		const select = document.getElementById("school-name");
		select.innerHTML="<option value=''>학교명</option>";
		const district = e.target.value;
		const schoolName = document.getElementById("school-type").value;
		fetch("${path}/post/school?district=" + district + "&schoolType=" + schoolName)
			.then(response => response.json())
			.then(data => {
				data.forEach(school => {
					const option = document.createElement("option");
					option.value = school;
					option.textContent = school;
					select.appendChild(option);
				});
			})
			.catch(error => console.error("Error : ",error));
	};
	/* 카테고리 선택에 따라 지역,학교 선택칸 출력 */
	const selector = document.getElementById("selector");
	
	selector.addEventListener("change", function() {
		const val = selector.value;
		if(val==="region") {
			$("#region-container").removeClass("hidden");
			$("#school-container").addClass("hidden");
		} else if (val==="school") {
			$("#school-container").removeClass("hidden");
			$("#region-container").removeClass("hidden");
		} else {
			$("#region-container").addClass("hidden");
			$("#school-container").addClass("hidden");
		}
	});
	/* 파일 업로드시, 프리뷰 사진 출력 */
	$("#upfile").change(e=>{
		$("#preview").html('');
		$.each($(e.target)[0].files,(i,file)=>{
			const fileReader = new FileReader();
			fileReader.readAsDataURL(file);
			fileReader.onload=e=>{
				const path = e.target.result;
				const $img = $("<img>").attr({
					src:path,
					height:"200px",
				});
				$("#preview").append($img);
			}
		})
	});
	
</script>
<jsp:include page="/WEB-INF/views/common/footer.jsp"/>
```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/webapp/WEB-INF/views/post/uploadPost2.jsp
```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>
<!-- jQuery가 먼저 로드되어 있어야 합니다 -->
<link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.js"></script>
<c:set var="path" value="${pageContext.request.contextPath}" />
<jsp:include page="/WEB-INF/views/common/header.jsp"/>
<jsp:include page="/WEB-INF/views/common/sidebar.jsp"/>
<link rel="stylesheet" href="${pageContext.request.contextPath }/resources/css/post/uploadPost.css">
<section class="main-content col-9">
	<div id="post-container" class="col-12">
		<h2>게시글 작성</h2>
	    
	    <div id='board-container'>
	    	<form action='${path }/post/uploadpost2' method="post" enctype="multipart/form-data" >
	    		<table>
	    			<tr id="school-container">
	    				<td>
	    					<select id="sido">
	          					<option value="">전체지역</option>
	       					 </select>
	    				</td>
	    				<td>
	    					<select id="gungu">
	          					<option value="">구/군</option>
	        				</select>
	    				</td>
	    				<td>
	    					<select id="school-name">
	          					<option value="">학교/학원명</option>
	        				</select>
	    				</td>
	    			</tr>
	    			<tr id="category">
	    				<th>카테고리</th>
	    				<td colspan="2">
	    					<select>
	    						<option value="">카테고리 선택</option>
	    					</select>
	    				</td>
	    			</tr>
	    			<tr>
	    				<th>제목</th>
	    				<td colspan="2">
	    					<input type="text" name="boardTitle"/>
	    				</td>
	    			</tr>
	    			<tr>
	    				<th>작성자</th>
	    				<td colspan="2">
	    					<input type="text" name="boardWriter"
									value="${sessionScope.loginMember.userNick }" readOnly/>
	    				</td>
	    			</tr>
	    			<tr>
	    				<th>첨부파일</th>
	    				<td colspan="2">
	    					<input type="file" name="upfile"/>
	    				</td>
	    			</tr>
	    			<tr>
					    <th>내용</th>
					    <td colspan="2">
					        <input type="hidden" name="boardContent">  <!-- 실제 폼 전송을 위한 hidden input -->
					        <div id="summernote"></div>  <!-- summernote가 적용될 div -->
					    </td>
					</tr>
	    		</table>
	    	</form>
	    </div>
	    <div id="button-container">
	    	<div class="right">
	    		<input type="submit" value="저장"> <input type="submit" value="등록">
		    </div>
	    </div>
	 </div>
</section>

<script>
$(document).ready(function() {
    $('#summernote').summernote({
        height: 300,                 // 에디터 높이
        minHeight: null,             // 최소 높이
        maxHeight: null,             // 최대 높이
        focus: true,                 // 에디터 로딩후 포커스를 맞출지 여부
        lang: "ko-KR",               // 한글 설정
        placeholder: '내용을 입력해주세요',  // placeholder 설정
        callbacks: {
            onImageUpload : function(files) {
                // 파일 업로드 처리
                for(let i = 0; i < files.length; i++) {
                    uploadSummernoteImageFile(files[i]);
                }
            }
        }
    });
});

// 이미지 파일 업로드 함수
function uploadSummernoteImageFile(file) {
    const formData = new FormData();
    formData.append("file", file);
    
    $.ajax({
        url: '${path}/uploadSummernoteImageFile',  // 이미지를 저장할 서버 URL
        type: "POST",
        data: formData,
        contentType: false,
        processData: false,
        success: function(data) {
            $('#summernote').summernote('insertImage', data.url);
        },
        error: function(err) {
            console.log(err);
        }
    });
}

$("form").submit(function() {
    var content = $('#summernote').summernote('code');
    $('input[name=boardContent]').val(content);
    return true;
});
</script>
<jsp:include page="/WEB-INF/views/common/footer.jsp"/>
```

## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/webapp/WEB-INF/views/post/viewPost.jsp
```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>
<script	src="${pageContext.request.contextPath }/resources/js/jquery-3.7.1.min.js"></script>
<link rel="stylesheet" href="${pageContext.request.contextPath }/resources/css/post/viewPost.css">
<c:set var="path" value="${pageContext.request.contextPath}" />
<jsp:include page="/WEB-INF/views/common/header.jsp"/>
<jsp:include page="/WEB-INF/views/common/sidebar.jsp"/>

<!-- 메인 콘텐츠 영역 시작 지검 -->
<section class="main-content col-9">
	<section id="post-container">
		<div id="content-container">
		<c:if test="${post.member.memberNick==loginMember.memberNick }">
			<button type="submit" id="update-btn">수정</button>
			<button type="submit" id="delete-btn">삭제</button>		
		</c:if>
		<table id="post-tbl">
			<tr class="category-name">
				<td colspan="2">categoryName</td>
			</tr>
			<tr class="post-title">
				<td colspan="2"><h3>${post.postTitle }</h3></td>
			</tr>
			<tr class="info">
				<td><img src="https://img.icons8.com/?size=100&id=30M9wv1iFkcH&format=png&color=000000" width="10px">  viewCount</td>
				<td>${post.createDate }</td>
			</tr>
			<tr class="member-name">
				<td colspan="2">${post.member.memberNick }</td>
			</tr>
			<c:if test="${not empty post.images}">
				<tr class="file">
					<td colspan="2">
						<c:forEach var="image" items="${images }">
							<img src="${image }" style="max-width:200px; max-height:200px; margin:5px;">
						</c:forEach>
					</td>
				</tr>
			</c:if>
			
			<tr class="content">
				<td colspan="2">${post.postContent }</td>
			</tr>
		</table>
		</div>
		<div id="comment-container">
			<div class="comment-editor">
				<form action="${path }/post/postcomment.do" method="post">
					<input type="hidden" name="memberNo" value="${post.member.memberNo }"/>
					<input type="hidden" name="postNo" value="${post.postNo }"/>
					<input type="hidden" name="postRef" value="%{}"/>
					<input type="hidden" name="level" value="1"/>
					<input type="hidden" name="writer" value="${loginMember.memberNick }"/>
					<input type="hidden" name="postCommentRef" value="0"/>
					<textarea name="content" rows="3" style="width: 950px; resize:none;"></textarea>
					<button type="submit" id="comment-btn">등록</button>
				</form>
			</div>
			<table id="comment-tbl">
			<c:if test="${not empty post.comments }">
				<c:forEach var="comment" items="${post.comments }">
					<c:if test="${comment.level==1 }">
						<tr class="level1">
							<td class="comment-writer">댓글 작성자명 ${comment.member.memberNick }</td>
							<td class="comment-date">댓글 작성일 ${comment.createDate }</td>
						</tr>
						<tr>
							<td class="comment-content">댓글 내용 ${comment.comment }</td>	
							<td>
								<button class="recomment-btn" value="${comment.commentNo }">대댓글</button>
							</td>
						</tr>
					</c:if>
					<c:if test="${comment1.level==2 }">
						<tr class="level2">
							<td class="comment-writer">댓글 작성자명 ${comment.member.memberNick }</td>
							<td class="comment-date">댓글 작성일 ${comment.createDate }</td>
						</tr>
						<tr>
							<td class="comment-content">댓글 내용 ${comment.comment }</td>	
							<td>
								<button class="recomment-btn" value="${comment.commentNo }">대댓글</button>
							</td>
						</tr>
					</c:if>
				</c:forEach>
			</c:if>
				
				
			</table>
		</div>
		<div id="recommnet-container">
		</div>
	</section>
	
</section>
<!-- 메인 콘텐츠 영역 종료 -->
<script>
	
</script>
<jsp:include page="/WEB-INF/views/common/footer.jsp"/>
```



## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/webapp/WEB-INF/web.xml
```xml
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"
    version="4.0">
    
    <!-- 세션 설정 -->
    <session-config>
        <session-timeout>30</session-timeout>
    </session-config>
    
</web-app>
```


## 파일: C:/GitHub/EduTech_Full_Stack/Teachers_Project/Teachers_Project_1_Board/Teachers_1_Board/src/main/webapp/index.jsp
```jsp
	<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>
<jsp:include page="/WEB-INF/views/common/header.jsp"/>
<jsp:include page="/WEB-INF/views/common/sidebar.jsp"/>
<c:set var="path" value="${pageContext.request.contextPath}" />

<style>
/* 게시판 레이아웃 */
.mini-board, .video-container{
	background: none;
	border: none;
	padding: 0 20px 0 12px; /* 12px은 col-6의 margin값 -12를 맞춰주기 위함 값. */
	border-radius: 8px;
}
/* 게시판 헤더 */
.board-header {
	display: flex;
	justify-content: space-between;
	align-items: center;
	margin-bottom: 10px;
	/* padding: 15px; */ /* 내부 여백 */
	/* background: #f8f9fa; */ /* 배경색 */
	/* border-radius: 4px; */ /* 모서리 둥글게 */
}

.board-header h2 {
	margin: 0;
	font-weight: 900;
	/* font-size: 1.25rem; */ /* 제목 크기 */
	/* color: #212529; */ /* 제목 색상 */
}
/* 게시글 목록 관련 스타일 */
.post-row {
    padding: 20px 15px;              /* 내부 여백 */
    border-bottom: 1px solid #dee2e6; /* 구분선 */
    transition: background-color 0.2s; /* 호버 효과 전환 */
}

/* 제목과 통계를 감싸는 컨테이너 */
.post-row .d-flex > div:first-child {
    flex: 1;                        /* 남은 공간 모두 사용 */
    min-width: 0;                   /* 말줄임이 제대로 작동하게 함 */
    display: flex;                  /* 내부 요소 정렬을 위한 flex */
    align-items: center;            /* 수직 가운데 정렬 */
    gap: 8px;                       /* 내부 요소 간격 */
}

.post-row:hover {
    background-color: #f8f9fa;       /* 호버시 배경색 */
}

.post-title {
    text-decoration: none;
    color: #212529;                  /* 글자색 */
    font-size: 0.95rem;              /* 글자 크기 */
    font-weight: 500;                /* 글자 굵기 */
    white-space: nowrap;             /* 줄바꿈 방지 */
    overflow: hidden;                /* 넘치는 텍스트 숨김 */
    text-overflow: ellipsis;         /* 말줄임(...) 표시 */
    max-width: 450px;                /* 최대 너비 설정 */
    display: inline-block;           /* 인라인 블록 요소로 변경 */
}

.post-info {
    font-size: 0.8rem;               /* 시간 정보 글자 크기 */
    color: #6c757d;                  /* 시간 정보 색상 */
    margin-left: 8px;                /* 왼쪽 여백 */
}

.post-stats {
    flex-shrink: 0;   
    color: #6c757d;                  /* 통계 정보 색상 */
    font-size: 0.85rem;              /* 통계 정보 크기 */
}

.post-stats i {
    margin: 0 2px 0 8px;             /* 아이콘 여백 */
}

/* 로딩 스피너 구현을 위한 CSS */
.board-loader {
    display: none;
    padding: 20px 0;
    text-align: center;
}
.board-spinner {
    display: inline-block;
    width: 30px;
    height: 30px;
    border: 3px solid #f3f3f3;
    border-radius: 50%;
    border-top: 3px solid #D9776A;
    animation: boardSpin 1s linear infinite;
}
/* .loader-container {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(255, 255, 255, 0.8);
    z-index: 9999;
    justify-content: center;
    align-items: center;
}

.loader {
    border: 5px solid #f3f3f3;
    border-radius: 50%;
    border-top: 5px solid #D9776A;
    width: 50px;
    height: 50px;
    animation: spin 1s linear infinite;
} */

@keyframes boardSpin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
</style>

<!-- 메인 콘텐츠 영역 시작 지검 -->
<section class="main-content col-9">
	<!-- 2행: 2단 분할 (1:1) -->
	<div class="row two-columns">
		<div style="width:550px; padding:0;">
			<div class="video-container">
				<div class="main-title board-header">
					<h2>추천 동영상</h2>
					<!-- <button id="btn-post" class="account-button">글쓰기</button> -->
				</div>
				<div class="video-content"><img alt="moms" src="${path }/resources/images/momsTeacher.png" style="width:100%"></div>
				<div class="video-content">
					<iframe 
					    width="100%" 
					    height="100%" 
					    src="https://www.youtube.com/embed/3tLv12xK1xo?si=VS2g-5M6-kyjcyFa&amp;controls=0&amp;autoplay=1&amp;mute=1" 
					    title="YouTube video player" 
					    frameborder="0" 
					    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
					    referrerpolicy="strict-origin-when-cross-origin" 
					    allowfullscreen>
					</iframe>
				</div>
			</div>
		</div>
		<div style="width:550px; padding:0;">
			<div class="mini-board">
				<div class="main-title board-header">
					<h2>추천글</h2>
					<!-- <button id="btn-post" class="account-button">글쓰기</button> -->
				</div>
				<!-- 개별 로딩 스피너 추가 -->
			    <div class="board-loader">
			        <div class="board-spinner"></div>
			    </div>
				<!-- 게시판 테이블 대신 리스트 형태로 변경 -->
				<div class="board-list">
					<%-- <c:forEach var="post" items="${unsolvedPosts}">
						<div class="post-row">
							<div class="d-flex justify-content-between align-items-center">
								<div>
									<!-- 게시글 제목 -->
									<a href="${path}/board/postview.do?postNo=${post.postNo}"
										class="post-title"> ${post.postTitle} </a> 
								</div>
								<div class="post-info"> 
					                <!-- 좋아요, 댓글 수 정보 -->
					                <span class="post-stats">
					                    <i class="bi bi-suit-heart-fill"></i> ${post.likeCount}
					                    <i class="bi bi-chat-left-heart-fill"></i> ${post.commentCount+300}
					                </span>
				                </div>
							</div>
						</div>
					</c:forEach> --%>
				</div>

			</div>
		</div>
	</div>

	<div class="row two-columns">
		<!-- 첫 번째 게시판 -->
		<div style="width:550px; padding:0;">
			<div class="mini-board">
				<div class="main-title board-header">
					<h2>학년별(로그인한 정보)</h2>
					<!-- <button id="btn-post" class="account-button">글쓰기</button> -->
				</div>
				<!-- 개별 로딩 스피너 추가 -->
			    <div class="board-loader">
			        <div class="board-spinner"></div>
			    </div>
				<!-- 게시판 테이블 대신 리스트 형태로 변경 -->
				<div class="board-list">
					<%-- <c:forEach var="post" items="${unsolvedPosts}">
						<div class="post-row">
							<div class="d-flex justify-content-between align-items-center">
								<div>
									<!-- 게시글 제목 -->
									<a href="${path}/board/postview.do?postNo=${post.postNo}"
										class="post-title"> ${post.postTitle} </a> 
								</div>
								<div class="post-info"> 
					                <!-- 좋아요, 댓글 수 정보 -->
					                <span class="post-stats">
					                    <i class="bi bi-suit-heart-fill"></i> ${post.likeCount}
					                    <i class="bi bi-chat-left-heart-fill"></i> ${post.commentCount+300}
					                </span>
				                </div>
							</div>
						</div>
					</c:forEach> --%>
				</div>

			</div>
		</div>
		<!-- 두 번째 게시판 -->
		<div style="width:550px; padding:0;">
			<div class="mini-board">
				<div class="main-title board-header">
					<h2>고민상담</h2>
					<!-- <button id="btn-post" class="account-button">글쓰기</button> -->
				</div>
				<!-- 개별 로딩 스피너 추가 -->
			    <div class="board-loader">
			        <div class="board-spinner"></div>
			    </div>
				<!-- 게시판 테이블 대신 리스트 형태로 변경 -->
				<div class="board-list">
					<%-- <c:forEach var="post" items="${solvedPosts}">
						<div class="post-row">
							<div class="d-flex justify-content-between align-items-center">
								<div>
									<!-- 게시글 제목 -->
									<a href="${path}/board/postview.do?postNo=${post.postNo}"
										class="post-title"> ${post.postTitle} </a> 
								</div>
								<div class="post-info"> 
					                <!-- 좋아요, 댓글 수 정보 -->
					                <span class="post-stats">
					                    <i class="bi bi-suit-heart-fill"></i> ${post.likeCount}
					                    <i class="bi bi-chat-left-heart-fill"></i> ${post.commentCount+300}
					                </span>
								</div>
							</div>
						</div>
					</c:forEach> --%>
				</div>
			</div>
		</div>
	</div>
</section>
<!-- 메인 콘텐츠 영역 종료 -->
<script>
	// 페이지 로드 시 데이터 호출
	$(document).ready(function() {
	    loadBoardData();
	});
	
	// 서버에서 데이터를 가져오는 함수
	function loadBoardData() {
	    // 모든 스피너 표시
	    $('.board-loader').show();
	    $('.board-list').hide();
	    
	 	// Ajax를 통해 서버에 데이터 요청
	    $.ajax({
	        url: "${path}/home",
	        type: "GET",
	        dataType: "json",
	        timeout: 8000, // 8초 타임아웃 설정
	        headers: {
	            'Accept': 'application/json'
	        },
	        // 가져온 데이터를 updateBoard()에 전달하여 각 게시판을 업데이트
	        success: function(data) {
	            // 추천글 게시판 데이터 적용
	            updateBoard('.mini-board:eq(0) .board-list', data.favoritePosts);
	            // 학년별 게시판 데이터 적용
	            updateBoard('.mini-board:eq(1) .board-list', data.middlePosts);
	            // 고민상담 게시판 데이터 적용
	            updateBoard('.mini-board:eq(2) .board-list', data.unsolvedPosts);
	        },
	        error: function(xhr, status, error) {
	            if(status === 'timeout') {
	                alert('서버 응답이 지연되고 있습니다. 잠시 후 다시 시도해주세요.');
	            } else {
	            console.error("Error loading data:", error);
	            }
	        },
	        complete: function() {
	            // 모든 스피너 숨김 & 컨텐츠 표시
	            $('.board-loader').hide();
	            $('.board-list').show();
	        }
	    });
	}
	
	// 실제로 HTML을 구성하는 함수
	function updateBoard(selector, posts) {
	    const boardList = $(selector);
	    const loader = boardList.siblings('.board-loader');
	    
	    // 해당 게시판의 로딩 스피너 표시
	    loader.show();
	    boardList.hide();
	    
	    boardList.empty(); // 기존 내용 비우기

	    // 받아온 게시글 데이터로 HTML 생성
	    posts.forEach(post => {
	        const postHtml = `
	            <div class="post-row">
	                <div class="d-flex justify-content-between align-items-center">
	                    <div>
	                        <a href="${path}/post/viewpost?postNo=\${post.postNo}" 
	                           class="post-title">\${post.postTitle}</a>
	                    </div>
	                    <div class="post-info">
	                        <span class="post-stats">
	                            <i class="bi bi-suit-heart-fill"></i> \${post.likeCount}
	                            <i class="bi bi-chat-left-heart-fill"></i> \${post.commentCount+300}
	                        </span>
	                    </div>
	                </div>
	            </div>`;
	        boardList.append(postHtml);
	    });

	    // 해당 게시판의 로딩 스피너 숨김 & 컨텐츠 표시
	    loader.hide();
	    boardList.show();
	}
</script>
<jsp:include page="/WEB-INF/views/common/footer.jsp"/>

```



